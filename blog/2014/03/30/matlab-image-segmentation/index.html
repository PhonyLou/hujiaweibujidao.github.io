
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Matlab Image Segmentation - Hujiawei Bujidao</title>
  <meta name="author" content="hujiawei">

  
  <meta name="description" content="1.基于迭代的自动阈值图像分割方法 参考文献: 基于迭代(自动阈值)算法的医学图像增强方法 该文献实现了全局和局部的图像分割代码，使用的都是迭代算法，对比下面的结果可以看出，在灰度差异特别大的图像中，局部阈值分割要比全局阈值分割表现更好。[注:我对源码略有修改] 1.1 全局阈值分割程序 1
2 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://hujiaweibujidao.github.io/blog/2014/03/30/matlab-image-segmentation">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Hujiawei Bujidao" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<!-- add Mathjax support-->
<!--
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>
-->
  

</head>

<body   >
	<header role="banner">
		<hgroup style="text-align: center">
	<h1><a href="/"><img src="/images/conan-paper-small.png"  />Hujiawei Bujidao<img src="/images/conan-hat-small.png"  /></a></h1>
	
	<h2>I will always be your savior! A secret makes a man man!</h2>
	
	
</hgroup>


	</header>
	<nav role="navigation">
		<ul class="subscription" data-subscription="rss">

  <!-- <li><a href="https://github.com/hujiaweibujidao" rel="subscribe-rss" title="subscribe via RSS">View me on GitHub</a></li> -->
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
   
</ul>

  <!--
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:hujiaweibujidao.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form> 
  
  -->
<ul class="main-navigation">
  <li><a href="/blog/archives/">Blog</a></li>
  <li><a href="/aboutme/">AboutMe</a></li>
  <li><a href="/math/">Math</a></li>
  <!--
  <li><a href="/datamining/">DataMining</a></li>
  -->
  <li><a href="/blog/categories/mobiledev/">MobileDev</a></li>
  <!--
  <li><a href="/xjava/">XJava</a></li>
  -->
  <!-- <li><a href="/datamining/">Projects</a></li> -->
  <!--
  <li><a href="/blog/archives">Archives</a></li>
  -->
</ul>


	</nav>
	<div id="main">
		<div id="content">
			<div>
	<article class="hentry" role="article">
		
  <header>
    
      <h1 class="entry-title">Matlab Image Segmentation</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-30T16:13:00+08:00" pubdate data-updated="true">Mar 30<span>th</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>1.基于迭代的自动阈值图像分割方法</p>

<p>参考文献: <a href="/files/image_segmentation.pdf">基于迭代(自动阈值)算法的医学图像增强方法</a></p>

<p>该文献实现了全局和局部的图像分割代码，使用的都是迭代算法，对比下面的结果可以看出，在灰度差异特别大的图像中，局部阈值分割要比全局阈值分割表现更好。[注:我对源码略有修改]</p>

<p>1.1 全局阈值分割程序</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>original_image=imread('test1.png');
</span><span class='line'>gray_image=rgb2gray(original_image);
</span><span class='line'>gray_image=double(gray_image);
</span><span class='line'>t=mean(gray_image(:));
</span><span class='line'>is_done=false;
</span><span class='line'>count=0;%迭代次数
</span><span class='line'>block=gray_image(1:end,1:end);%不分块
</span><span class='line'>while ~is_done
</span><span class='line'>    r1=find(gray_image&lt;=t);
</span><span class='line'>    r2=find(gray_image&gt;t);
</span><span class='line'>    temp1=mean(block(r1));
</span><span class='line'>    if isnan(temp1);
</span><span class='line'>        temp1=0;
</span><span class='line'>    end
</span><span class='line'>    temp2=mean(block(r2));
</span><span class='line'>    if isnan(temp2)
</span><span class='line'>        temp2=0;
</span><span class='line'>    end
</span><span class='line'>    t_new=(temp1+temp2)/2;
</span><span class='line'>    is_done=abs(t_new-t)&lt;1;%差异阈值是1
</span><span class='line'>    t=t_new;
</span><span class='line'>    count=count+1;
</span><span class='line'>    if count&gt;=1000
</span><span class='line'>        Error='Error:Cannot find the ideal threshold.'
</span><span class='line'>        return
</span><span class='line'>    end
</span><span class='line'>end
</span><span class='line'>[m,n]=size(gray_image);
</span><span class='line'>result=zeros(m,n)+255;
</span><span class='line'>result(r1)=0;
</span><span class='line'>% resule(r2)=255;
</span><span class='line'>result=uint8(result);
</span><span class='line'>figure
</span><span class='line'>imshow(result);</span></code></pre></td></tr></table></div></figure>


<p>1.2 局部阈值分割程序</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>original_image=imread('test1.png');
</span><span class='line'>gray_image=rgb2gray(original_image);
</span><span class='line'>gray_image=double(gray_image);
</span><span class='line'>[m,n]=size(gray_image);
</span><span class='line'>result=zeros(m,n);
</span><span class='line'>block_size=70;%分块大小
</span><span class='line'>for i=1:block_size:m
</span><span class='line'>    for j=1:block_size:n
</span><span class='line'>        if ((i+block_size)&gt;m)&&((j+block_size)&gt;n)
</span><span class='line'>            block=gray_image(i:end,j:end);
</span><span class='line'>        elseif ((i+block_size)&gt;m)&&((j+block_size)&lt;=n)
</span><span class='line'>            block=gray_image(i:end,j:j+block_size-1);
</span><span class='line'>        elseif ((i+block_size)&lt;=m)&&((j+block_size)&gt;n)
</span><span class='line'>            block=gray_image(i:i+block_size-1,j:end);
</span><span class='line'>        else
</span><span class='line'>            block=gray_image(i:i+block_size-1,j:j+block_size-1);
</span><span class='line'>        end
</span><span class='line'>        t=mean(block(:)); t_org=t; is_done=false; count=0;
</span><span class='line'>        while ~is_done
</span><span class='line'>            r1=find(block&lt;=t); r2=find(block&gt;t); temp1=mean(block(r1));
</span><span class='line'>            if isnan(temp1);
</span><span class='line'>                temp1=0;
</span><span class='line'>            end
</span><span class='line'>            temp2=mean(block(r2));
</span><span class='line'>            if isnan(temp2)
</span><span class='line'>                temp2=0;
</span><span class='line'>            end
</span><span class='line'>            t_new=(temp1+temp2)/2; is_done=abs(t_new-t)&lt;1; t=t_new;
</span><span class='line'>            count=count+1;
</span><span class='line'>            if count&gt;=1000
</span><span class='line'>                Error='Error:Cannot find the ideal threshold.'
</span><span class='line'>                return
</span><span class='line'>            end
</span><span class='line'>        end
</span><span class='line'>        block(r1)=0;
</span><span class='line'>        block(r2)=255;
</span><span class='line'>        if ((i+block_size)&gt;m)&&((j+block_size)&gt;n)
</span><span class='line'>            result(i:end,j:end)=block;
</span><span class='line'>        elseif ((i+block_size)&gt;m)&&((j+block_size)&lt;=n)
</span><span class='line'>            result(i:end,j:j+block_size-1)=block;
</span><span class='line'>        elseif ((i+block_size)&lt;=m)&&((j+block_size)&gt;n)
</span><span class='line'>            result(i:i+block_size-1,j:end)=block;
</span><span class='line'>        else
</span><span class='line'>            result(i:i+block_size-1,j:j+block_size-1)=block;
</span><span class='line'>        end
</span><span class='line'>    end
</span><span class='line'>end
</span><span class='line'>resule=uint8(result);
</span><span class='line'>figure
</span><span class='line'>imshow(result);</span></code></pre></td></tr></table></div></figure>


<p>对比结果：</p>

<p><img src="/images/201403/whole.png" width="320" height="210"> <img src="/images/201403/partial.png" width="320" height="210"></p>

<p>2.基于OSTU算法的自动阈值图像分割</p>

<p>[这块我还没有细究&hellip;To be continued&hellip;&hellip;]</p>

<p>Matlab内置的<code>graythresh</code>使用的便是OSTU算法，使得白色像素和黑色像素的类间方差最大。</p>

<p>因为上面测试图像的亮度存在明显的水平差异，所以我写了一个将图像沿水平方向分成几部分分别进行OSTU算法，效果明显又比上面两种方式要好些。</p>

<p><img src="/images/201403/postu.png"></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>function [ result ] = partialostu( image,part,isrgb )
</span><span class='line'>%PARTIALOSTU partial image ostu
</span><span class='line'>if isrgb
</span><span class='line'>    image=rgb2gray(image);
</span><span class='line'>end
</span><span class='line'>cols=size(image,2);
</span><span class='line'>result=zeros(size(image));
</span><span class='line'>for i=1:part
</span><span class='line'>    fstart=floor((i-1)*cols/part)+1;
</span><span class='line'>    fend=floor(i*cols/part);
</span><span class='line'>    f=image(:,fstart:fend);
</span><span class='line'>    t=graythresh(f);
</span><span class='line'>    f=im2bw(f,t);
</span><span class='line'>    result(:,fstart:fend)=f;
</span><span class='line'>end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p class='post-footer'>
                        Original link:<a href='http://hujiaweibujidao.github.io/blog/2014/03/30/matlab-image-segmentation/'>http://hujiaweibujidao.github.io/blog/2014/03/30/matlab-image-segmentation/</a><br/>Written by <a href='http://hujiaweibujidao.github.io'>hujiawei</a>&nbsp;Posted at <a href='http://hujiaweibujidao.github.io'>http://hujiaweibujidao.github.io</a><br/>Feel free to read or comment it, and if you want to copy it into your own site, please copy it with its Original Link showed above or you can see the license below for more details.<br />Thanks a lot. Hope you enjoy here! ^_^</p>

</div>


		<footer>
			<p class="meta">
				
  

<span class="byline author vcard">Posted by <span class="fn">hujiawei</span></span>

				








  


<time datetime="2014-03-30T16:13:00+08:00" pubdate data-updated="true">Mar 30<span>th</span>, 2014</time>
				

<span class="categories">
  
    <a class='category' href='/blog/categories/matlab/'>matlab</a>
  
</span>


			</p>
			
			<div class="sharing">
  
  
  
</div>

			
			<p class="meta">
				
				<a class="basic-alignment left" href="/blog/2014/03/13/mobile-development-materials/" title="Previous Post: Material on Mobile Development">&laquo; Material on Mobile Development</a>
				
				
				<a class="basic-alignment right" href="/blog/2014/04/05/principal-component-analysis/" title="Next Post: Principal Component Analysis">Principal Component Analysis &raquo;</a>
				
			</p>
		</footer>
	</article>
	

	
	<section>
		<h1>Comments</h1>
		<div id="comments" aria-live="polite">
			<!-- Duoshuo Comment BEGIN   data-title=""-->
<div class="ds-thread"></div>
<script type="text/javascript">
  var duoshuoQuery = {short_name:"hujiaweibujidao"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
<!-- Duoshuo Comment END -->

		</div>
	</section>
	

</div>

<aside class="sidebar">
	
	<section>
  <h1>关于博主</h1><br/>
  <a href="/aboutme/"><img src="/images/me-small.png" width="250px" height="210px" alt="protrait"/></a><br/>
  <p>Hi, I'm Hujiawei, from P.R.China. Now I'm a postgraduate student studying in <a href="http://www.tsinghua.edu.cn/publish/th/index.html">Tsinghua University</a>.
  Wanna know me? <a href="/aboutme/">See here.</a> <br/>	
  </p>
  <a href="http://weibo.com/hujiaweiyinger"><img src="/images/sinaweibo.png" width="40px" height="40px"/></a> &nbsp;
  <a href="https://github.com/hujiaweibujidao"><img src="/images/github.png" width="40px" height="40px"/></a>&nbsp;
  <a href="http://hujiawei.tumblr.com"><img src="/images/tumblr.png" width="40px" height="40px"/></a> &nbsp;
  <a href="https://twitter.com/hujiaweiyinger"><img src="/images/twitter.png" width="40px" height="40px"/></a>
  
  <br/>
  
</section>
<section>
 <h1>分类目录</h1>
 <ul id="categories">
	 <li class='category'><a href='/blog/categories/algorithm/'>algorithm (2)</a></li>
<li class='category'><a href='/blog/categories/android/'>android (5)</a></li>
<li class='category'><a href='/blog/categories/ios/'>ios (1)</a></li>
<li class='category'><a href='/blog/categories/mac/'>mac (2)</a></li>
<li class='category'><a href='/blog/categories/math/'>math (3)</a></li>
<li class='category'><a href='/blog/categories/matlab/'>matlab (1)</a></li>
<li class='category'><a href='/blog/categories/ml/'>ml (1)</a></li>
<li class='category'><a href='/blog/categories/mobiledev/'>mobiledev (5)</a></li>
<li class='category'><a href='/blog/categories/octopress/'>octopress (2)</a></li>
<li class='category'><a href='/blog/categories/opencv/'>opencv (5)</a></li>

 </ul>
</section>
<section>
  <h1>近期文章</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/04/24/calculus-summary/">Calculus Summary</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/23/numerical-methods-using-matlab/">Numerical Methods Using Matlab</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/22/probability-and-statistics-summary/">Probability and Statistics Summary</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/15/flying-on-mac/">Flying on Mac</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/13/vertext-cover-problem/">Vertext Cover Problem</a>
      </li>
    
  </ul>
</section>
<section>
	<h1>好友博客</h1>
	<ul>
		<li>
			<a href="http://doufunao.github.io/">豆腐脑的幻想乡</a>
		</li>
		<li>
			<a href="http://c4fun.cn/">Code 4 Fun</a>
		</li>
		<li>
			<a href="http://www.tanglei.name/">TangLei blog</a>
		</li>
		<li>
			<a href="http://ontheroad.sinaapp.com/">Tian Jun-Find My Way</a>
		</li>
		
		<li>
			<a href="http://www.liaoxuefeng.com/">廖雪峰的官方网站</a>
		</li>
		<li>
			<a href="http://wufawei.com/">Ted's Homepage</a>
		</li>
		<li>
			<a href="http://www.renfei.org/blog/">Renfei Song</a>
		</li>
		<li>
			<a href="http://bluedavy.me">BlueDavy之技术blog</a>
		</li>
		
		<li>
			<a href="#">这里会是你吗?</a>
		</li>
	</ul>
</section>
	
</aside>



		</div>
	</div>
	
	<footer role="contentinfo">
		<p>
	Copyright &copy; 2014 - hujiawei - <a href="http://happybirthday2yinger.duapp.com/">Happy birthday to MY QUEEN</a> - <span class="credit">Proudly Powered by <a href="http://octopress.org">Octopress</a></span>

<!-- Mathjax StackExchange -->
<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
	
	<!-- CNZZ -->
	&nbsp;&nbsp;
	<script type="text/javascript">
		var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
		document.write(unescape("%3Cspan id='cnzz_stat_icon_1000165127'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s22.cnzz.com/z_stat.php%3Fid%3D1000165127%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
	</script>
	<!-- license -->
	<a rel="license" href="http://creativecommons.org/licenses/by-nd/3.0/deed.zh"><img alt="知识共享许可协议" style="border-width:0" src="http://i.creativecommons.org/l/by-nd/3.0/88x31.png" /></a>
	<br />
	本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nd/3.0/deed.zh">知识共享署名-禁止演绎 3.0 未本地化版本许可协议</a>进行许可。
</p>
<style>
	.returnTop {
		position: fixed;
		_position: absolute;
		right: 10px;
		bottom: 200px;
		_bottom: auto;
		display: none;
		width: 40px;
		height: 40px;
		border: 1px solid #61b72e;
		border-radius: 4px;
		background: #fff;
		box-shadow: 0 0 5px #F5F5F5;
		text-indent: -9999px;
		cursor: pointer;
	}
	.returnTop .s {
		position: absolute;
		top: -2px;
		_top: -20px;
		left: 10px;
		width: 0;
		height: 0;
		border-width: 10px;
		border-color: transparent transparent #61b72e;
		border-style: dashed dashed solid;
	}
	.returnTop .b {
		position: absolute;
		top: 18px;
		left: 16px;
		height: 12px;
		width: 8px;
		background: #61b72e;
	}
</style>
<div class="returnTop" title="嗖的就上去了！">
	<span class="s"></span>
	<span class="b"></span>
	返回顶部
</div>
<script type="text/javascript">
$(function(){
$(window).bind("scroll", function(){

var scrollTopNum = $(document).scrollTop(),
winHeight = $(window).height(),
returnTop = $("div.returnTop");

(scrollTopNum > 0) ? returnTop.fadeIn("fast") : returnTop.fadeOut("fast");

if (!-[1,]&&!window.XMLHttpRequest) {
returnTop.css("top", scrollTopNum + winHeight - 200);
}

});

$("div.returnTop").click(function() {
$("html, body").animate({ scrollTop: 0 }, 100);
});

});
</script>



	</footer>
	
	











</body>
</html>
